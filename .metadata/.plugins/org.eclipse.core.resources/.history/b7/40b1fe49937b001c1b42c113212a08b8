package factory.dp.jdbc;

import java.sql.*;

public class JdbcConnectionDemo {
		public static void main(String[] args) {
			//loading driver
			try {
				Class.forName("com.mysql.jdbc.Driver");
				System.out.println("Driver loaded");
			} catch (ClassNotFoundException e1) {
				e1.printStackTrace();
			}
			try {
				//creating connection object
				Connection connection = DriverManager.getConnection
						(
								"jdbc:mysql://localhost:3306/ymsli",
								"root",
								"root");
				System.out.println("Connection succesfull");
//				Statement createStmt = connection.createStatement();
//				createStmt.execute("create table Book (id integer not null auto_increment, author varchar(255), isbn varchar(255), price double precision not null, title varchar(255), primary key (id));");
//				
				PreparedStatement statement = connection.prepareStatement("insert into Book (author, isbn, price, title) values (?, ?, ?, ?)");
				statement.setString(1, "yash");
				statement.setInt(2,1234 );
				statement.setDouble(3, 3333.6);
				statement.setString(4, "java head first");
				statement.executeUpdate();
				
				//Print all the details from table
				PreparedStatement getDetails = connection.prepareStatement("select * from Book");
				ResultSet result = getDetails.executeQuery();
				System.out.println("[AUTHOR]: [ISBN] : [PRICE] : [TITLE]");
				while(result.next()) {
					System.out.println(result.getString(1)+":"+result.getInt(2)+":"+result.getDouble(3)+":"+result.getString(4));
				}
			} catch (SQLException e) {
				e.printStackTrace();
			}
		}
}
